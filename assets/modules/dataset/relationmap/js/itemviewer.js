/*!***********************************************
 Copyright (c) 2016, Neusoft Inc.
 All rights reserved
 SaCa DataViz Version 3.1.0
 ************************************************/
var _semantics_diagram_item_viewer_cls={surface:null,dimension:null,item:null,keyId:null,anchors:null,itemRect:null,fill:null,id:null,name:null,checkedIcon:null,uncheckedIcon:null,_parent:null,constructor:function(e,t){this.item=e,this._parent=t,this.events=[],this._initDimension()},destroy:function(){this.surface.removeShape()},setGraphicContext:function(e){this.surface=e.surface,e.width&&(this.dimension.width=e.width),e.fill?this.fill=e.fill:this.fill=_infosetStyle.itemFill1,this._initView()},getHeight:function(){return this.dimension.itemHeight},_initDimension:function(){var e=320,t=135,i=135,n=26,c=12,h=15;this.dimension={itemHeight:n,width:e,margin:h,checkboxWidth:c,itemTextHeight:n/2+4,idWidth:t,nameWidth:i}},_initView:function(){var e=this.surface,t=this.dimension,i=this.itemRect=e.createRect({x:0,y:0,width:t.width,height:t.itemHeight});i.setFill(this.fill),i.rawNode.style&&(i.rawNode.style.cursor="move");var n=this.id=e.createText({x:t.margin,y:t.itemTextHeight,text:this.textAdaptionWidth(this.item.id,t.idWidth),align:_infosetStyle.itemAlign});n.setFill(_infosetStyle.itemTextFill),n.setFont(_infosetStyle.itemFont),n.rawNode.style&&(n.rawNode.style.cursor="move");var c=this.name=e.createText({x:t.margin+t.idWidth,y:t.itemTextHeight,text:this.textAdaptionWidth(this.item.name,t.nameWidth),align:_infosetStyle.itemAlign});c.setFill(_infosetStyle.itemTextFill),c.setFont(_infosetStyle.itemFont),c.rawNode.style&&(c.rawNode.style.cursor="move");var h=this.checkedIcon=e.createImage({x:t.width-t.checkboxWidth-t.margin,y:(t.itemHeight-t.checkboxWidth)/2,width:t.checkboxWidth,height:t.checkboxWidth,src:_infosetStyle.checkIcons.checked});h.rawNode.style&&(h.rawNode.style.cursor="pointer");var s=this.uncheckedIcon=e.createImage({x:t.width-t.checkboxWidth-t.margin,y:(t.itemHeight-t.checkboxWidth)/2,width:t.checkboxWidth,height:t.checkboxWidth,src:_infosetStyle.checkIcons.unchecked});s.rawNode.style&&(s.rawNode.style.cursor="pointer"),this.item.checked?e.remove(s):e.remove(h),this._initEvent()},_initEvent:function(){this.checkedIcon.connect("onclick",this,"toRemoveComputeItem"),this.uncheckedIcon.connect("onclick",this,"toaddComputeItem")},toRemoveComputeItem:function(){dojo.publish("/semantics/removeComputeItem",[this.item]),this.changeChecked(!1),dojo.publish("/semantics/adjustSetCheckStatus",[this.item.setId])},toaddComputeItem:function(){dojo.publish("/semantics/addComputeItem",[this.item]),this.changeChecked(!0),dojo.publish("/semantics/adjustSetCheckStatus",[this.item.setId])},changeChecked:function(e){this.item.checked=e,e?(this.surface.remove(this.uncheckedIcon),this.surface.add(this.checkedIcon)):(this.surface.remove(this.checkedIcon),this.surface.add(this.uncheckedIcon))},relocate:function(e,t){this.surface.applyLeftTransform({dx:e,dy:t})},textAdaptionWidth:function(e,t){for(var i="",n=0,c=0;c<e.length;c++){var h=0;if(h=e.charCodeAt(c)>255?12:7,!(t-20>=n+h)){i+="...";break}i+=e[c],n+=h}return i}};dojo.declare("semantics.diagram.ItemViewer",null,_semantics_diagram_item_viewer_cls);