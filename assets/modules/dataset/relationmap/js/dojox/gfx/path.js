/*!***********************************************
 Copyright (c) 2016, Neusoft Inc.
 All rights reserved
 SaCa DataViz Version 3.1.0
 ************************************************/
dojo._hasResource["dojox.gfx.path"]||(dojo._hasResource["dojox.gfx.path"]=!0,dojo.provide("dojox.gfx.path"),dojo.require("dojox.gfx.matrix"),dojo.require("dojox.gfx.shape"),dojo.declare("dojox.gfx.path.Path",dojox.gfx.shape.Shape,{constructor:function(t){this.shape=dojo.clone(dojox.gfx.defaultPath),this.segments=[],this.tbbox=null,this.absolute=!0,this.last={},this.rawNode=t,this.segmented=!1},setAbsoluteMode:function(t){return this._confirmSegmented(),this.absolute="string"==typeof t?"absolute"==t:t,this},getAbsoluteMode:function(){return this._confirmSegmented(),this.absolute},getBoundingBox:function(){return this._confirmSegmented(),this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){if(this._confirmSegmented(),this.tbbox)return this.tbbox;var t=this.bbox,s=this._getRealMatrix();this.bbox=null;for(var e=0,i=this.segments.length;i>e;++e)this._updateWithSegment(this.segments[e],s);var h=this.bbox;return this.bbox=t,this.tbbox=h?[{x:h.l,y:h.t},{x:h.r,y:h.t},{x:h.r,y:h.b},{x:h.l,y:h.b}]:null,this.tbbox},getLastPosition:function(){return this._confirmSegmented(),"x"in this.last?this.last:null},_applyTransform:function(){return this.tbbox=null,this.inherited(arguments)},_updateBBox:function(t,s,e){if(e){var i=dojox.gfx.matrix.multiplyPoint(e,t,s);t=i.x,s=i.y}this.bbox&&"l"in this.bbox?(this.bbox.l>t&&(this.bbox.l=t),this.bbox.r<t&&(this.bbox.r=t),this.bbox.t>s&&(this.bbox.t=s),this.bbox.b<s&&(this.bbox.b=s)):this.bbox={l:t,b:s,r:t,t:s}},_updateWithSegment:function(t,s){var e=t.args,i=e.length;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(var h=0;i>h;h+=2)this._updateBBox(e[h],e[h+1],s);this.last.x=e[i-2],this.last.y=e[i-1],this.absolute=!0;break;case"H":for(var h=0;i>h;++h)this._updateBBox(e[h],this.last.y,s);this.last.x=e[i-1],this.absolute=!0;break;case"V":for(var h=0;i>h;++h)this._updateBBox(this.last.x,e[h],s);this.last.y=e[i-1],this.absolute=!0;break;case"m":var o=0;"x"in this.last||(this._updateBBox(this.last.x=e[0],this.last.y=e[1],s),o=2);for(var h=o;i>h;h+=2)this._updateBBox(this.last.x+=e[h],this.last.y+=e[h+1],s);this.absolute=!1;break;case"l":case"t":for(var h=0;i>h;h+=2)this._updateBBox(this.last.x+=e[h],this.last.y+=e[h+1],s);this.absolute=!1;break;case"h":for(var h=0;i>h;++h)this._updateBBox(this.last.x+=e[h],this.last.y,s);this.absolute=!1;break;case"v":for(var h=0;i>h;++h)this._updateBBox(this.last.x,this.last.y+=e[h],s);this.absolute=!1;break;case"c":for(var h=0;i>h;h+=6)this._updateBBox(this.last.x+e[h],this.last.y+e[h+1],s),this._updateBBox(this.last.x+e[h+2],this.last.y+e[h+3],s),this._updateBBox(this.last.x+=e[h+4],this.last.y+=e[h+5],s);this.absolute=!1;break;case"s":case"q":for(var h=0;i>h;h+=4)this._updateBBox(this.last.x+e[h],this.last.y+e[h+1],s),this._updateBBox(this.last.x+=e[h+2],this.last.y+=e[h+3],s);this.absolute=!1;break;case"A":for(var h=0;i>h;h+=7)this._updateBBox(e[h+5],e[h+6],s);this.last.x=e[i-2],this.last.y=e[i-1],this.absolute=!0;break;case"a":for(var h=0;i>h;h+=7)this._updateBBox(this.last.x+=e[h+5],this.last.y+=e[h+6],s);this.absolute=!1}for(var a=[t.action],h=0;i>h;++h)a.push(dojox.gfx.formatNumber(e[h],!0));"string"==typeof this.shape.path?this.shape.path+=a.join(""):Array.prototype.push.apply(this.shape.path,a)},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(t,s){this.tbbox=null;var e=this._validSegments[t.toLowerCase()];if("number"==typeof e)if(e){if(s.length>=e){var i={action:t,args:s.slice(0,s.length-s.length%e)};this.segments.push(i),this._updateWithSegment(i)}}else{var i={action:t,args:[]};this.segments.push(i),this._updateWithSegment(i)}},_collectArgs:function(t,s){for(var e=0;e<s.length;++e){var i=s[e];"boolean"==typeof i?t.push(i?1:0):"number"==typeof i?t.push(i):i instanceof Array?this._collectArgs(t,i):"x"in i&&"y"in i&&t.push(i.x,i.y)}},moveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"M":"m",t),this},lineTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"L":"l",t),this},hLineTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"H":"h",t),this},vLineTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"V":"v",t),this},curveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"C":"c",t),this},smoothCurveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"S":"s",t),this},qCurveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"Q":"q",t),this},qSmoothCurveTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"T":"t",t),this},arcTo:function(){this._confirmSegmented();var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"A":"a",t),this},closePath:function(){return this._confirmSegmented(),this._pushSegment("Z",[]),this},_confirmSegmented:function(){if(!this.segmented){var t=this.shape.path;this.shape.path=[],this._setPath(t),this.shape.path=this.shape.path.join(""),this.segmented=!0}},_setPath:function(t){var s=dojo.isArray(t)?t:t.match(dojox.gfx.pathSvgRegExp);if(this.segments=[],this.absolute=!0,this.bbox={},this.last={},s){for(var e="",i=[],h=s.length,o=0;h>o;++o){var a=s[o],n=parseFloat(a);isNaN(n)?(e&&this._pushSegment(e,i),i=[],e=a):i.push(n)}this._pushSegment(e,i)}},setShape:function(t){return this.inherited(arguments,["string"==typeof t?{path:t}:t]),this.segmented=!1,this.segments=[],dojox.gfx.lazyPathSegmentation||this._confirmSegmented(),this},_2PI:2*Math.PI}),dojo.declare("dojox.gfx.path.TextPath",dojox.gfx.path.Path,{constructor:function(t){"text"in this||(this.text=dojo.clone(dojox.gfx.defaultTextPath)),"fontStyle"in this||(this.fontStyle=dojo.clone(dojox.gfx.defaultFont))},getText:function(){return this.text},setText:function(t){return this.text=dojox.gfx.makeParameters(this.text,"string"==typeof t?{text:t}:t),this._setText(),this},getFont:function(){return this.fontStyle},setFont:function(t){return this.fontStyle="string"==typeof t?dojox.gfx.splitFontString(t):dojox.gfx.makeParameters(dojox.gfx.defaultFont,t),this._setFont(),this}}));