/*!***********************************************
 Copyright (c) 2016, Neusoft Inc.
 All rights reserved
 SaCa DataViz Version 3.1.0
 ************************************************/
dojo._hasResource["dojox.gfx.svg"]||(dojo._hasResource["dojox.gfx.svg"]=!0,dojo.provide("dojox.gfx.svg"),dojo.require("dojox.gfx._base"),dojo.require("dojox.gfx.shape"),dojo.require("dojox.gfx.path"),function(){function t(t,e){return dojo.doc.createElementNS?dojo.doc.createElementNS(t,e):dojo.doc.createElement(e)}function e(t){return a.useSvgWeb?dojo.doc.createTextNode(t,!0):dojo.doc.createTextNode(t)}function i(){return a.useSvgWeb?dojo.doc.createDocumentFragment(!0):dojo.doc.createDocumentFragment()}var r=dojo,s=dojox.gfx,o=s.shape,a=s.svg,n=0;a.useSvgWeb="undefined"!=typeof window.svgweb;var d=s.svg;d.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"},a.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"},a.getRef=function(t){return t&&"none"!=t?t.match(/^url\(#.+\)$/)?r.byId(t.slice(5,-1)):t.match(/^#dojoUnique\d+$/)?r.byId(t.slice(1)):null:null},a.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},r.declare("dojox.gfx.svg.Shape",o.Shape,{setFill:function(t){if(!t)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var e,i=function(t){this.setAttribute(t,e[t].toFixed(8))};if("object"==typeof t&&"type"in t){switch(t.type){case"linear":e=s.makeParameters(s.defaultLinearGradient,t);var o=this._setFillObject(e,"linearGradient");r.forEach(["x1","y1","x2","y2"],i,o);break;case"radial":e=s.makeParameters(s.defaultRadialGradient,t);var o=this._setFillObject(e,"radialGradient");r.forEach(["cx","cy","r"],i,o);break;case"pattern":e=s.makeParameters(s.defaultPattern,t);var a=this._setFillObject(e,"pattern");r.forEach(["x","y","width","height"],i,a)}return this.fillStyle=e,this}var e=s.normalizeColor(t);return this.fillStyle=e,this.rawNode.setAttribute("fill",e.toCss()),this.rawNode.setAttribute("fill-opacity",e.a),this.rawNode.setAttribute("fill-rule","evenodd"),this},setStroke:function(t){var e=this.rawNode;if(!t)return this.strokeStyle=null,e.setAttribute("stroke","none"),e.setAttribute("stroke-opacity",0),this;("string"==typeof t||r.isArray(t)||t instanceof r.Color)&&(t={color:t});var i=this.strokeStyle=s.makeParameters(s.defaultStroke,t);if(i.color=s.normalizeColor(i.color),i){e.setAttribute("stroke",i.color.toCss()),e.setAttribute("stroke-opacity",i.color.a),e.setAttribute("stroke-width",i.width),e.setAttribute("stroke-linecap",i.cap),"number"==typeof i.join?(e.setAttribute("stroke-linejoin","miter"),e.setAttribute("stroke-miterlimit",i.join)):e.setAttribute("stroke-linejoin",i.join);var o=i.style.toLowerCase();if(o in a.dasharray&&(o=a.dasharray[o]),o instanceof Array){o=r._toArray(o);for(var n=0;n<o.length;++n)o[n]*=i.width;if("butt"!=i.cap){for(var n=0;n<o.length;n+=2)o[n]-=i.width,o[n]<1&&(o[n]=1);for(var n=1;n<o.length;n+=2)o[n]+=i.width}o=o.join(",")}e.setAttribute("stroke-dasharray",o),e.setAttribute("dojoGfxStrokeStyle",i.style)}return this},_getParentSurface:function(){for(var t=this.parent;t&&!(t instanceof s.Surface);t=t.parent);return t},_setFillObject:function(e,i){var r=a.xmlns.svg;this.fillStyle=e;var o=this._getParentSurface(),n=o.defNode,d=this.rawNode.getAttribute("fill"),h=a.getRef(d);if(h)if(d=h,d.tagName.toLowerCase()!=i.toLowerCase()){var l=d.id;d.parentNode.removeChild(d),d=t(r,i),d.setAttribute("id",l),n.appendChild(d)}else for(;d.childNodes.length;)d.removeChild(d.lastChild);else d=t(r,i),d.setAttribute("id",s._base._getUniqueId()),n.appendChild(d);if("pattern"==i){d.setAttribute("patternUnits","userSpaceOnUse");var u=t(r,"image");u.setAttribute("x",0),u.setAttribute("y",0),u.setAttribute("width",e.width.toFixed(8)),u.setAttribute("height",e.height.toFixed(8)),u.setAttributeNS(a.xmlns.xlink,"xlink:href",e.src),d.appendChild(u)}else{d.setAttribute("gradientUnits","userSpaceOnUse");for(var p=0;p<e.colors.length;++p){var f=e.colors[p],c=t(r,"stop"),g=f.color=s.normalizeColor(f.color);c.setAttribute("offset",f.offset.toFixed(8)),c.setAttribute("stop-color",g.toCss()),c.setAttribute("stop-opacity",g.a),d.appendChild(c)}}return this.rawNode.setAttribute("fill","url(#"+d.getAttribute("id")+")"),this.rawNode.removeAttribute("fill-opacity"),this.rawNode.setAttribute("fill-rule","evenodd"),d},_applyTransform:function(){var t=this.matrix;if(t){var e=this.matrix;this.rawNode.setAttribute("transform","matrix("+e.xx.toFixed(8)+","+e.yx.toFixed(8)+","+e.xy.toFixed(8)+","+e.yy.toFixed(8)+","+e.dx.toFixed(8)+","+e.dy.toFixed(8)+")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(t){var e=this.rawNode=t;"image"!=this.shape.type&&e.setAttribute("fill","none"),e.setAttribute("fill-opacity",0),e.setAttribute("stroke","none"),e.setAttribute("stroke-opacity",0),e.setAttribute("stroke-width",1),e.setAttribute("stroke-linecap","butt"),e.setAttribute("stroke-linejoin","miter"),e.setAttribute("stroke-miterlimit",4)},setShape:function(t){this.shape=s.makeParameters(this.shape,t);for(var e in this.shape)"type"!=e&&this.rawNode.setAttribute(e,this.shape[e]);return this.bbox=null,this},_moveToFront:function(){return this.rawNode.parentNode.appendChild(this.rawNode),this},_moveToBack:function(){return this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild),this},setClip:function(e){if(e){for(var i,r,s=this.rawNode.childNodes,o=!1,a=0;a<s.length;a++)"clipPath"==s[a].tagName&&(i=s[a],i.removeChild(i.childNodes[0]),o=!0);if(o)r=t(d.xmlns.svg,"rect"),i.appendChild(r);else{var h=++n,l="url(#gfx_clip"+h+")",u="gfx_clip"+h;this.rawNode.setAttribute("clip-path",l),i=t(d.xmlns.svg,"clipPath"),r=t(d.xmlns.svg,"rect"),i.appendChild(r),this.rawNode.appendChild(i),dojo.attr(i,"id",u)}var p={};p.y="string"==typeof e.y?e.y:e.y.toFixed(0),p.width="string"==typeof e.width?e.width:e.width.toFixed(0),p.height="string"==typeof e.height?e.height:e.height.toFixed(0),p.x="string"==typeof e.x?e.x:e.x.toFixed(0),dojo.attr(r,{x:p.x,y:p.y,width:p.width,height:p.height})}else{this.rawNode.removeAttribute("clip-path");for(var s=this.rawNode.childNodes,a=0;a<s.length;a++)"clipPath"==s[a].tagName&&this.rawNode.removeChild(s[a])}}}),dojo.declare("dojox.gfx.svg.Group",a.Shape,{constructor:function(){o.Container._init.call(this)},setRawNode:function(t){this.rawNode=t}}),a.Group.nodeType="g",dojo.declare("dojox.gfx.svg.Rect",[a.Shape,o.Rect],{setShape:function(t){this.shape=s.makeParameters(this.shape,t),this.bbox=null;for(var e in this.shape)"type"!=e&&"r"!=e&&this.rawNode.setAttribute(e,this.shape[e]);return this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r)),this}}),a.Rect.nodeType="rect",dojo.declare("dojox.gfx.svg.Ellipse",[a.Shape,o.Ellipse],{}),a.Ellipse.nodeType="ellipse",dojo.declare("dojox.gfx.svg.Circle",[a.Shape,o.Circle],{}),a.Circle.nodeType="circle",dojo.declare("dojox.gfx.svg.Line",[a.Shape,o.Line],{}),a.Line.nodeType="line",dojo.declare("dojox.gfx.svg.Polyline",[a.Shape,o.Polyline],{setShape:function(t,e){t&&t instanceof Array?(this.shape=s.makeParameters(this.shape,{points:t}),e&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=s.makeParameters(this.shape,t),this.bbox=null,this._normalizePoints();for(var i=[],r=this.shape.points,o=0;o<r.length;++o)i.push(r[o].x.toFixed(8),r[o].y.toFixed(8));return this.rawNode.setAttribute("points",i.join(" ")),this}}),a.Polyline.nodeType="polyline",dojo.declare("dojox.gfx.svg.Image",[a.Shape,o.Image],{setShape:function(t){this.shape=s.makeParameters(this.shape,t),this.bbox=null;var e=this.rawNode;for(var i in this.shape)"type"!=i&&"src"!=i&&e.setAttribute(i,this.shape[i]);return e.setAttribute("preserveAspectRatio","none"),e.setAttributeNS(a.xmlns.xlink,"xlink:href",this.shape.src),this}}),a.Image.nodeType="image",dojo.declare("dojox.gfx.svg.Text",[a.Shape,o.Text],{setShape:function(t){this.shape=s.makeParameters(this.shape,t),this.bbox=null;var i=this.rawNode,r=this.shape;return i.setAttribute("x",r.x),i.setAttribute("y",r.y),i.setAttribute("text-anchor",r.align),i.setAttribute("text-decoration",r.decoration),i.setAttribute("rotate",r.rotated?90:0),i.setAttribute("kerning",r.kerning?"auto":0),i.setAttribute("text-rendering","optimizeLegibility"),i.firstChild?i.firstChild.nodeValue=r.text:i.appendChild(e(r.text)),this},getTextWidth:function(){var t=this.rawNode,e=t.parentNode,i=t.cloneNode(!0);i.style.visibility="hidden";var r=0,s=i.firstChild.nodeValue;if(e.appendChild(i),""!=s)for(;!r;)r=i.getBBox?parseInt(i.getBBox().width):68;return e.removeChild(i),r}}),a.Text.nodeType="text",dojo.declare("dojox.gfx.svg.Path",[a.Shape,s.path.Path],{_updateWithSegment:function(t){this.inherited(arguments),"string"==typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)},setShape:function(t){return this.inherited(arguments),this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d"),this}}),a.Path.nodeType="path",dojo.declare("dojox.gfx.svg.TextPath",[a.Shape,s.path.TextPath],{_updateWithSegment:function(t){this.inherited(arguments),this._setTextPath()},setShape:function(t){return this.inherited(arguments),this._setTextPath(),this},_setTextPath:function(){if("string"==typeof this.shape.path){var i=this.rawNode;if(!i.firstChild){var r=t(a.xmlns.svg,"textPath"),o=e("");r.appendChild(o),i.appendChild(r)}var n=i.firstChild.getAttributeNS(a.xmlns.xlink,"href"),d=n&&a.getRef(n);if(!d){var h=this._getParentSurface();if(h){var l=h.defNode;d=t(a.xmlns.svg,"path");var u=s._base._getUniqueId();d.setAttribute("id",u),l.appendChild(d),i.firstChild.setAttributeNS(a.xmlns.xlink,"xlink:href","#"+u)}}d&&d.setAttribute("d",this.shape.path)}},_setText:function(){var i=this.rawNode;if(!i.firstChild){var r=t(a.xmlns.svg,"textPath"),s=e("");r.appendChild(s),i.appendChild(r)}i=i.firstChild;var o=this.text;switch(i.setAttribute("alignment-baseline","middle"),o.align){case"middle":i.setAttribute("text-anchor","middle"),i.setAttribute("startOffset","50%");break;case"end":i.setAttribute("text-anchor","end"),i.setAttribute("startOffset","100%");break;default:i.setAttribute("text-anchor","start"),i.setAttribute("startOffset","0%")}i.setAttribute("baseline-shift","0.5ex"),i.setAttribute("text-decoration",o.decoration),i.setAttribute("rotate",o.rotated?90:0),i.setAttribute("kerning",o.kerning?"auto":0),i.firstChild.data=o.text}}),a.TextPath.nodeType="text",dojo.declare("dojox.gfx.svg.Surface",o.Surface,{constructor:function(){o.Container._init.call(this)},destroy:function(){this.defNode=null,this.inherited(arguments)},setDimensions:function(t,e){return this.rawNode?(this.rawNode.setAttribute("width",t),this.rawNode.setAttribute("height",e),this):this},getDimensions:function(){var t=this.rawNode?{width:s.normalizedLength(this.rawNode.getAttribute("width")),height:s.normalizedLength(this.rawNode.getAttribute("height"))}:null;return t}}),a.createSurface=function(e,i,s){var o=new a.Surface;o.rawNode=t(a.xmlns.svg,"svg"),i&&o.rawNode.setAttribute("width",i),s&&o.rawNode.setAttribute("height",s);var n=t(a.xmlns.svg,"defs");return o.rawNode.appendChild(n),o.defNode=n,o._parent=r.byId(e),o._parent.appendChild(o.rawNode),o};var h={_setFont:function(){var t=this.fontStyle;this.rawNode.setAttribute("font-style",t.style),this.rawNode.setAttribute("font-variant",t.variant),this.rawNode.setAttribute("font-weight",t.weight),this.rawNode.setAttribute("font-size",t.size),this.rawNode.setAttribute("font-family",t.family)}},l=o.Container,u={openBatch:function(){this.fragment=i()},closeBatch:function(){this.fragment&&(this.rawNode.appendChild(this.fragment),delete this.fragment)},add:function(t){return this!=t.getParent()&&(this.fragment?this.fragment.appendChild(t.rawNode):this.rawNode.appendChild(t.rawNode),l.add.apply(this,arguments)),this},remove:function(t,e){return this==t.getParent()&&(this.rawNode==t.rawNode.parentNode&&this.rawNode.removeChild(t.rawNode),this.fragment&&this.fragment==t.rawNode.parentNode&&this.fragment.removeChild(t.rawNode),l.remove.apply(this,arguments)),this},clear:function(){for(var t=this.rawNode;t.lastChild;)t.removeChild(t.lastChild);var e=this.defNode;if(e){for(;e.lastChild;)e.removeChild(e.lastChild);t.appendChild(e)}return l.clear.apply(this,arguments)},_moveChildToFront:l._moveChildToFront,_moveChildToBack:l._moveChildToBack},p={createObject:function(e,i){if(!this.rawNode)return null;var r=new e,s=t(a.xmlns.svg,e.nodeType);return r.setRawNode(s),r.setShape(i),this.add(r),r}};if(r.extend(a.Text,h),r.extend(a.TextPath,h),r.extend(a.Group,u),r.extend(a.Group,o.Creator),r.extend(a.Group,p),r.extend(a.Surface,u),r.extend(a.Surface,o.Creator),r.extend(a.Surface,p),a.useSvgWeb){a.createSurface=function(e,i,o){var n=new a.Surface;if(!i||!o){var d=r.position(e);i=i||d.w,o=o||d.h}e=r.byId(e);var h=e.id?e.id+"_svgweb":s._base._getUniqueId(),l=t(a.xmlns.svg,"svg");return l.id=h,l.setAttribute("width",i),l.setAttribute("height",o),svgweb.appendChild(l,e),l.addEventListener("SVGLoad",function(){n.rawNode=this,n.isLoaded=!0;var e=t(a.xmlns.svg,"defs");n.rawNode.appendChild(e),n.defNode=e,n.onLoad&&n.onLoad(n)},!1),n.isLoaded=!1,n},a.Surface.extend({destroy:function(){var t=this.rawNode;svgweb.removeChild(t,t.parentNode)}});var f={connect:function(t,e,i){return"on"===t.substring(0,2)&&(t=t.substring(2)),i=2==arguments.length?e:r.hitch(e,i),this.getEventSource().addEventListener(t,i,!1),[this,t,i]},disconnect:function(t){this.getEventSource().removeEventListener(t[1],t[2],!1),delete t[0]}};dojo.extend(a.Shape,f),dojo.extend(a.Surface,f)}"svg"===s.loadAndSwitch&&(s.switchTo("svg"),delete s.loadAndSwitch)}());